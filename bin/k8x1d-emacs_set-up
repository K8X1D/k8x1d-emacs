#!/bin/sh
# Adapted from https://guix.gnu.org/cookbook/en/html_node/Reproducible-profiles.html

K8X1D_EMACS_PROFILES=$HOME/.k8x1d-emacs-profiles
GUIX_EXTRA=$HOME/.guix-extra

mkdir -p "$GUIX_EXTRA/k8x1d-emacs"
guix pull --channels=channels.scm --profile="$GUIX_EXTRA/k8x1d-emacs/guix"

mkdir -p "$K8X1D_EMACS_PROFILES/$XDG_SESSION_TYPE"
"$GUIX_EXTRA"/k8x1d-emacs/guix/bin/guix package --manifest==~/.k8x1d-emacs.d/k8x1d-emacs.scm --profile="$K8X1D_EMACS_PROFILES/$XDG_SESSION_TYPE/$XDG_SESSION_TYPE"

notify-send -a "k8x1d-emacs" "Set-up" "Finished"
